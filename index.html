<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OreStellar</title>

<!-- Google Font: Orbitron -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

<style>
  /* General body styling */
  body {
    margin: 0;
    background: #000;
    color: #fff;
    font-family: 'Orbitron', sans-serif;
    overflow-x: hidden;
  }

  /* Logo canvas */
  #logoCanvas {
    display: block;
    margin: 0 auto;
    background: transparent;
  }

  /* Inventory container styling */
  #inventoryContainer {
    text-align: center;
    margin-top: 20px;
  }
  #inventoryContainer textarea {
    width: 80%;
    height: 150px;
    background: #000;
    color: #fff;
    border: 1px solid #fff;
    font-family: 'Orbitron', sans-serif;
    font-size: 14px;
    padding: 10px;
  }
  #submitButton {
    margin-top: 10px;
    padding: 10px 20px;
    background: #000;
    border: 1px solid #fff;
    color: #fff;
    font-family: 'Orbitron', sans-serif;
    cursor: pointer;
  }

  /* Summary container styling */
  #summaryContainer {
    display: none;
    position: absolute;
    top: 200px;
    left: 50%;
    transform: translateX(-50%);
    width: 80%;
    text-align: center;
    border: 1px solid #fff;
    padding: 20px;
    box-shadow: 0 0 20px #fff;
  }
  #summaryContainer table {
    width: 100%;
    border-collapse: collapse;
    color: #fff;
  }
  #summaryContainer th, #summaryContainer td {
    border: 1px solid #fff;
    padding: 8px;
  }
  #summaryContainer th {
    background: rgba(255,255,255,0.1);
  }

  /* Contract left/right placeholders */
  #contractLeft, #contractRight {
    position: absolute;
    top: 250px;
    width: 100px;
    height: 300px;
    border: 1px solid #fff;
  }
  #contractLeft { left: 20px; }
  #contractRight { right: 20px; }

  /* Neon effect */
  .neon {
    text-shadow:
      0 0 5px #fff,
      0 0 10px #fff,
      0 0 20px #fff,
      0 0 40px #fff;
  }
</style>
</head>
<body>

<!-- Logo Canvas -->
<canvas id="logoCanvas" width="600" height="150"></canvas>

<!-- Inventory Input -->
<div id="inventoryContainer">
  <textarea id="messageBox" placeholder="Paste your ore inventory here"></textarea><br>
  <button id="submitButton">Submit</button>
</div>

<!-- Summary Container -->
<div id="summaryContainer">
  <h2 class="neon">Ore Summary</h2>
  <table id="summaryTable">
    <thead>
      <tr>
        <th>Ore</th>
        <th>Quantity</th>
        <th>Price</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr>
        <th colspan="3">Grand Total</th>
        <th id="grandTotal">0</th>
      </tr>
    </tfoot>
  </table>
</div>

<!-- Contract placeholders -->
<div id="contractLeft"></div>
<div id="contractRight"></div>

<script>
/* ===== STARFIELD LOGO EXACT ===== */
const canvas = document.getElementById('logoCanvas');
const ctx = canvas.getContext('2d');
const stars = [];
const numStars = 100;

for(let i=0; i<numStars; i++){
  stars.push({
    x: Math.random()*canvas.width,
    y: Math.random()*canvas.height,
    radius: Math.random()*1.5,
    alpha: Math.random()
  });
}

function flickerStars() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = "#fff";
  stars.forEach(star=>{
    star.alpha += (Math.random()-0.5)*0.1;
    if(star.alpha < 0) star.alpha=0;
    if(star.alpha > 1) star.alpha=1;
    ctx.globalAlpha = star.alpha;
    ctx.beginPath();
    ctx.arc(star.x, star.y, star.radius, 0, Math.PI*2);
    ctx.fill();
  });
  ctx.globalAlpha = 1;
  // Draw OreStellar text
  ctx.font = "48px Orbitron";
  ctx.fillStyle = "#fff";
  ctx.textAlign = "center";
  ctx.fillText("OreStellar", canvas.width/2, canvas.height/2 + 16);
  requestAnimationFrame(flickerStars);
}
flickerStars();

/* ===== INVENTORY PARSING & SUMMARY ===== */
const priceList = {
  "Tritanium": { "150": 2.5, "other": 2 },
  "Pyerite": { "150": 3.1, "other": 2.5 },
  "Mexallon": { "150": 4.0, "other": 3.2 },
  // Add more ores here
};

function parseInventoryText(text) {
  const lines = text.split('\n').map(l=>l.trim()).filter(l=>l);
  const items = [];
  lines.forEach(line=>{
    const parts = line.split(/\s+/);
    if(parts.length >= 2){
      const qty = parseFloat(parts[1]);
      if(!isNaN(qty)){
        items.push({ name: parts[0], qty });
      }
    }
  });
  return items;
}

function renderSummary(items) {
  const tbody = document.querySelector("#summaryTable tbody");
  tbody.innerHTML = "";
  let grandTotal = 0;
  items.forEach(item=>{
    const priceEntry = priceList[item.name];
    const price = priceEntry ? (priceEntry["150"] || priceEntry["other"]) : 0;
    const total = price * item.qty;
    grandTotal += total;

    const row = document.createElement("tr");
    row.innerHTML = `<td>${item.name}</td>
                     <td>${item.qty}</td>
                     <td>${price}</td>
                     <td>${total.toFixed(2)}</td>`;
    tbody.appendChild(row);
  });
  document.getElementById("grandTotal").textContent = grandTotal.toFixed(2);
}

/* ===== SUBMIT BUTTON ===== */
const submitButton = document.getElementById("submitButton");
submitButton.addEventListener('click', ()=>{
  const txt = document.getElementById("messageBox").value.trim();
  if(!txt) return;

  const parsed = parseInventoryText(txt);
  renderSummary(parsed);

  document.getElementById("inventoryContainer").style.display = "none";
  document.getElementById("summaryContainer").style.display = "block";
});
</script>

</body>
</html>
