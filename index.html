<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Starfield Test</title>
<style>
html, body { margin:0; padding:0; overflow:hidden; background:black; }
canvas { display:block; position:fixed; top:0; left:0; z-index:-1; }
#content { position:relative; z-index:1; text-align:center; color:white; font-family:monospace; padding:20px; }
button { padding:10px 20px; font-weight:bold; margin-top:10px; cursor:pointer; }
</style>
</head>
<body>

<canvas id="starfield"></canvas>

<div id="content">
    <h1>OreStellar Demo</h1>
    <textarea id="message" rows="6" cols="40" placeholder="Compressed Ytirium 99&#10;Jet Ochre 135"></textarea><br>
    <button id="submitButton">Submit</button>
    <p id="totalPrice">0 ISK</p>
</div>

<script>
const canvas = document.getElementById('starfield');
const ctx = canvas.getContext('2d');

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

const colors = ['#ffffff','#ffffcc','#ffcccc'];
const numStars = 400;
const stars = [];

// Initialize stars
for(let i=0;i<numStars;i++){
    stars.push({
        x: Math.random()*canvas.width,
        y: Math.random()*canvas.height,
        z: Math.random()*canvas.width,
        color: colors[Math.floor(Math.random()*colors.length)],
        size: Math.random()*1+0.2
    });
}

function animate() {
    ctx.fillStyle='black';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    const cx = canvas.width/2;
    const cy = canvas.height/2;

    for(let s of stars){
        s.z -= 1; // forward speed
        if(s.z <= 0) {
            s.z = canvas.width;
            s.x = Math.random()*canvas.width;
            s.y = Math.random()*canvas.height;
            s.color = colors[Math.floor(Math.random()*colors.length)];
        }

        const sx = cx + (s.x-cx)*(canvas.width/s.z);
        const sy = cy + (s.y-cy)*(canvas.width/s.z);
        const r = s.size*(canvas.width/s.z*0.5);

        const grad = ctx.createRadialGradient(sx,sy,0,sx,sy,r);
        grad.addColorStop(0,s.color);
        grad.addColorStop(0.2,s.color+'33');
        grad.addColorStop(1,'transparent');

        ctx.fillStyle = grad;
        ctx.beginPath();
        ctx.arc(sx,sy,r,0,Math.PI*2);
        ctx.fill();
    }

    requestAnimationFrame(animate);
}
animate();

// Submit button demo
document.getElementById('submitButton').addEventListener('click', ()=>{
    const val = document.getElementById('message').value;
    let total = 0;
    val.split('\n').forEach(line=>{
        const m = line.match(/(\d+)$/);
        if(m) total += parseInt(m[1])*100;
    });
    document.getElementById('totalPrice').innerText = total.toLocaleString() + ' ISK';
});
</script>

</body>
</html>
